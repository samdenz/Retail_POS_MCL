<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cashier Performance | Retail POS</title>
    <link rel="stylesheet" href="css/pos.css">
    <style>
        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }
        .performance-table th, .performance-table td {
            border: 1px solid #ddd;
            padding: 12px 16px;
            text-align: left;
        }
        .performance-table th {
            background: #222;
            color: #fff;
        }
        .performance-table tr:nth-child(even) {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Retail POS</h2>
            </div>
            <nav>
                <a href="admin-dashboard.html">Dashboard</a>
                <a href="admin-inventory.html">Inventory</a>
                <a href="admin-reports.html">Reports</a>
                <a href="admin-users.html">Users</a>
                <a href="profile.html">Profile</a>
                <a href="cashier-performance.html" class="active">Cashier Performance</a>
                <button id="back-btn">Back</button>
                <button id="logout-btn">Logout</button>
            </nav>
        </aside>
        <main class="main-content">
            <h1>Cashier Performance</h1>
            <section>
                <table class="performance-table" id="performance-table">
                    <thead>
                        <tr>
                            <th>Cashier Name</th>
                            <th>Total Sales</th>
                            <th>Total Revenue</th>
                            <th>Transactions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </section>
        </main>
    </div>
    <script>
    // Access control: Only allow admins
    const user = JSON.parse(localStorage.getItem('pos_user'));
    if (!user || !user.role || user.role.toLowerCase() !== 'admin') {
        window.location.href = 'login.html';
    }

    // Back button navigation and logout
    window.addEventListener('DOMContentLoaded', () => {
        const backBtn = document.getElementById('back-btn');
        if (backBtn) {
            backBtn.addEventListener('click', () => {
                window.history.back();
            });
        }
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', () => {
                localStorage.removeItem('pos_user');
                localStorage.removeItem('pos_token');
                window.location.href = 'login.html';
            });
        }
        loadPerformance();
    });

    // Load cashier performance data
    async function loadPerformance() {
        const tableBody = document.querySelector('#performance-table tbody');
        tableBody.innerHTML = '<tr><td colspan="4">Loading...</td></tr>';
        try {
            const token = localStorage.getItem('pos_token');
            const res = await fetch('http://localhost:3000/api/admin/cashier-performance', {
                headers: { 'Authorization': 'Bearer ' + token }
            });
            const data = await res.json();
            if (Array.isArray(data) && data.length > 0) {
                tableBody.innerHTML = data.map(row => `
                    <tr>
                        <td>${row.name}</td>
                        <td>${row.total_sales}</td>
                        <td>$${row.total_revenue}</td>
                        <td>${row.transactions}</td>
                    </tr>
                `).join('');
            } else {
                tableBody.innerHTML = '<tr><td colspan="4">No data available.</td></tr>';
            }
        } catch (err) {
            tableBody.innerHTML = '<tr><td colspan="4">Failed to load data.</td></tr>';
        }
    }
    </script>
</body>
</html>
