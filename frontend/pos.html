<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS | Retail POS</title>
    <link rel="stylesheet" href="css/pos.css">
</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Retail POS</h2>
            </div>
            <nav>
                <a href="pos.html" class="active">POS</a>
                <a href="cashier-history.html">My Sales</a>
                <a href="profile.html">Profile</a>
                <button id="logout-btn">Logout</button>
            </nav>
        </aside>
        <main class="main-content">
            <h1>Retail Point of Sale System</h1>
            <input type="text" id="search-bar" placeholder="Search by title or ISBN">
            <div style="display: flex; gap: 10px; margin-left: auto;">
                <button id="admin-panel-btn" style="display:none;">Admin Panel</button>
            </div>
     
        <section id="products-section"> 
            <!-- Product items will be dynamically inserted here --> 
        </section> 
 
        <section id="cart"> 
                        <!-- Confirmation Modal -->
                        <div id="confirm-modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:2000;align-items:center;justify-content:center;">
                            <div style="background:#fff;color:#222;padding:24px 32px;border-radius:10px;min-width:320px;max-width:90vw;max-height:90vh;overflow:auto;position:relative;">
                                <h3 id="confirm-title">Confirm Payment</h3>
                                <div id="confirm-details"></div>
                                <div id="mpesa-ref-div" style="margin:12px 0;display:none;">
                                    <label for="mpesa-ref">MPESA Reference:</label>
                                    <input type="text" id="mpesa-ref" placeholder="Enter MPESA code">
                                </div>
                                <div id="receipt-preview" style="margin:16px 0;display:none;"></div>
                                <button id="confirm-btn" style="background:#27ae60;color:#fff;border:none;border-radius:4px;padding:8px 16px;margin-right:8px;">Confirm</button>
                                <button id="cancel-btn" style="background:#e74c3c;color:#fff;border:none;border-radius:4px;padding:8px 16px;">Cancel</button>
                            </div>
                        </div>
                        <!-- Success Animation -->
                        <div id="success-animation" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:3000;align-items:center;justify-content:center;">
                            <div style="background:#fff;padding:32px 48px;border-radius:16px;text-align:center;box-shadow:0 8px 32px rgba(42,82,152,0.2);">
                                <h2 style="color:#27ae60;font-size:2.2rem;">âœ” Payment Confirmed!</h2>
                                <p style="color:#222;font-size:1.2rem;margin-top:12px;">Sale completed successfully.</p>
                            </div>
                        </div>
            <h2>Cart</h2> 
            <ul id="cart-items"></ul> 
            <p>Total: KES <span id="total">0</span></p> 
            <div style="margin:12px 0;">
                <label for="payment-method">Payment Method:</label>
                <select id="payment-method">
                    <option value="CASH">Cash</option>
                    <option value="MPESA">MPESA</option>
                </select>
            </div>
            <button id="checkout-btn">Checkout</button> 
        </section> 
 
        <!-- Receipt Modal --> 
        <div id="receipt-modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;"> 
            <div id="receipt-content" style="background:#fff;color:#222;padding:24px 32px;border-radius:10px;min-width:320px;max-width:90vw;max-height:90vh;overflow:auto;position:relative;"> 
                <button id="close-receipt" style="position:absolute;top:8px;right:8px;background:#e74c3c;color:#fff;border:none;border-radius:4px;padding:8px 12px;cursor:pointer;font-size:1.2rem;">&times;</button> 
                <div id="receipt-html"></div> 
                <div style="margin-top: 20px; display: flex; gap: 10px;">
    <script>
    // Access control: Allow cashier and admin only
    const user = JSON.parse(localStorage.getItem('pos_user'));
    if (!user || !user.role || (user.role.toLowerCase() !== 'cashier' && user.role.toLowerCase() !== 'admin')) {
        window.location.href = 'login.html';
    }
    </script>
                    <button id="print-receipt" class="admin-btn">Print</button> 
                    <button id="download-receipt" class="admin-btn">Download PDF</button> 
                </div>
            </div> 
        </div> 
 
        <section id="admin-panel" style="display:none;"> 
            <h2>Admin Panel</h2> 
            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px;">
                <button id="view-reports-btn" class="admin-btn">View Sales Reports</button> 
                <button id="manage-books-btn" class="admin-btn">Manage Books</button> 
                <button id="add-book-btn" class="admin-btn">Add Book</button> 
                <button id="manage-users-btn" class="admin-btn">Manage Users</button> 
            </div>
            <div id="admin-content"></div> 
        </section> 
    </main> 
    <script src="js/pos.js"></script>
    <script>
    // Access control: Allow admin and cashier
    const user = JSON.parse(localStorage.getItem('pos_user'));
    if (!user || !user.role || (user.role.toLowerCase() !== 'cashier' && user.role.toLowerCase() !== 'admin')) {
        window.location.href = 'login.html';
    }
    </script>
</body>
</html>